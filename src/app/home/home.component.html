<div class="home-container">
  <div class="people-list">
    <div class="header">
      <div>People</div>
      <button mat-raised-button (click)="People.Reset()">
        Reset / New Day
      </button>
      <button mat-icon-button (click)="People.Add_Person.Execute()">
        <mat-icon>add</mat-icon>
      </button>
    </div>
    @for (person of People.List; track person) {
    <div
      class="person-entry"
      [style.background-color]="
        People.Selected.Person === person ? 'black' : ''
      "
      (click)="People.Selected.Execute(person)"
    >
      <div
        style="
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          gap: 0.25rem;
        "
      >
        <button
          mat-icon-button
          style="color: crimson"
          (click)="People.Remove_Person(person)"
        >
          <mat-icon>delete</mat-icon>
        </button>
        <button
          mat-icon-button
          style="color: seagreen"
          (click)="Timer.Launch(person)"
        >
          <mat-icon>schedule</mat-icon>
        </button>
      </div>
      <div>{{ person.Name }}</div>
      <div>
        {{ person.Minutes }} :
        {{
          person.Seconds.toString().length < 2
            ? "0" + person.Seconds.toString()
            : person.Seconds
        }}
      </div>

      <!--Actions-->
      <div
        style="
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          gap: 0.25rem;
        "
      >
        <button
          mat-icon-button
          class="button-skip"
          [disabled]="person.Completed !== CompletionEnum.NA"
          (click)="Actions.Skip(person)"
        >
          <mat-icon>skip_next</mat-icon>
        </button>
        <button
          mat-icon-button
          class="button-complete"
          [disabled]="person.Completed !== CompletionEnum.NA"
          (click)="Actions.Complete(person)"
        >
          <mat-icon>verified</mat-icon>
        </button>
      </div>
    </div>
    }
  </div>
  <div class="microwave-container">
    <!--[matMenuTriggerFor]="MicrowaveMenu"-->
    <div class="microwave" usemap="#microwave_map_2"></div>
    <!-- <img class="microwave" usemap="#microwave_map" /> -->
    <map name="microwave_map">
      <area shape="circle" coords="175, 100, 500" />
    </map>
    <map name="microwave_map_2">
      <area
        shape="poly"
        coords="100,100,200,200,300,300"
        [matMenuTriggerFor]="MicrowaveMenu"
      />
    </map>
    <!-- <button>Nuke It...</button> -->
  </div>
</div>

<ng-template #AddPersonTemplate>
  <mat-toolbar>Add Person</mat-toolbar>
  <mat-form-field>
    <mat-label>Name</mat-label>
    <input matInput [(ngModel)]="People.Add_Person.Name" />
  </mat-form-field>
  <div
    style="
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    "
  >
    <button mat-raised-button [mat-dialog-close]="false">Cancel</button>
    <button mat-raised-button [mat-dialog-close]="true">Add Person</button>
  </div>
</ng-template>

<ng-template #TimerTemplate>
  <div
    style="
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.5rem;
      background-color: black;
      padding: 0.5rem;
    "
  >
    <!--Digital Display-->
    <div
      style="
        grid-column: 1 / span 3;
        height: calc(50px + 1rem);
        border: 1px solid white;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        padding: 0px 1rem;
      "
    >
      <div style="flex-grow: 1"></div>
      <div
        style="
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
        "
      >
        @for (i of Timer.Code.slice(0, 2); track $index) {
        <ng-container
          *ngTemplateOutlet="DigitalLetterTemplate; context: { digit: i }"
        ></ng-container>
        }
      </div>
      <div style="color: white; font-weight: bolder; font-size: 2rem">:</div>
      <div
        style="
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
        "
      >
        @for (i of Timer.Code.slice(2, 4); track $index) {
        <ng-container
          *ngTemplateOutlet="DigitalLetterTemplate; context: { digit: i }"
        ></ng-container>
        }
      </div>
    </div>
    <!--Keypad Buttons-->
    @for (i of [1,2,3,4,5,6,7,8,9]; track i) {
    <button
      mat-raised-button
      style="background-color: black; color: white; border: 1px solid white"
      (click)="Timer.AddTime(i)"
    >
      {{ i }}
    </button>
    }
    <button
      mat-raised-button
      style="background-color: black; color: white; border: 1px solid crimson"
      (click)="Timer.ClearTime()"
    >
      Clear
    </button>
    <button
      mat-raised-button
      style="background-color: black; color: white; border: 1px solid white"
      (click)="Timer.AddTime(0)"
    >
      0
    </button>
    <button
      mat-raised-button
      style="background-color: black; color: white; border: 1px solid seagreen"
      [mat-dialog-close]="true"
    >
      Enter
    </button>
  </div>
</ng-template>

<ng-template #DigitalLetterTemplate let-text let-digit="digit">
  <!-- <div style="color: white">{{ text ?? digit }}</div> -->
  <div class="digit-container">
    <div
      class="line line-0"
      [class.selected]="[0, 2, 3, 5, 6, 7, 8, 9].includes(digit)"
    ></div>
    <div
      class="line line-1"
      [class.selected]="[0, 1, 2, 3, 4, 7, 8, 9].includes(digit)"
    ></div>
    <div
      class="line line-2"
      [class.selected]="[0, 1, 3, 4, 5, 6, 7, 8, 9].includes(digit)"
    ></div>
    <div
      class="line line-3"
      [class.selected]="[0, 2, 3, 5, 6, 8, 9].includes(digit)"
    ></div>
    <div
      class="line line-4"
      [class.selected]="[0, 2, 6, 8].includes(digit)"
    ></div>
    <div
      class="line line-5"
      [class.selected]="[0, 4, 5, 6, 8, 9].includes(digit)"
    ></div>
    <div
      class="line line-6"
      [class.selected]="[2, 3, 4, 5, 6, 8, 9].includes(digit)"
    ></div>
  </div>
</ng-template>

<mat-menu #MicrowaveMenu="matMenu">
  <div mat-menu-item>Check Microwave</div>
  <div mat-menu-item>Nuke It...</div>
</mat-menu>
